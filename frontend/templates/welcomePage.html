{% extends "base.html" %}

{% block rel %}
    <link rel="stylesheet" href="/static/css/welcomePage.css">
{% endblock %}

{% block page_title %}
    <title>Welcome to Manage Your Security Evaluations</title>
{% endblock %}

{% block content %}
    {% if not current_user.is_authenticated %}
        <div class="pre_login">
        </div>
        <h1>Manage Your Security Evaluations</h1>
        <div class='welcome_login'>
            <a href="{{ url_for('auth.login') }}">Login</a>
        </div>
    {% elif current_user.is_authenticated %}
        <div class="after_login">
        </div>
        <table>
            <tr>
                <td>
                    <h2>Welcome, {{ current_user.name }}!</h2>
                    <form action="/update" method="POST">
                        <div>
                            <label class="title">Your Profile</label>
                        </div>
                        <div>
                            <label class="attribute">Name: </label>
                            <input type="text" name="name" value="{{ current_user.name }}"/>
                        </div>
                        <div>
                            <label class="attribute">Email: </label>
                            <label>{{ current_user.email }}</label>
                        </div>
                        <div>
                            <label class="attribute">Role:</label>
                            <label>{{ current_user.role.name }}</label>
                        </div>
                        <div>
                            <label class="attribute">New Password:</label>
                            <input type="password" name="password" placeholder="Password"><br>
                        </div>
                        <div>
                            <label class="attribute"></label>
                            <input type="submit" name="action" value="Update"/>
                        </div>
                    </form>
                </td>
                <td>
                    <div>
                        {% if evidence_list %}
                            {% if current_user.role.name == 'DEV' or current_user.role.name == 'Admin' %}
                                <h2>Evidence Uploaded by you: </h2>
                                <table id="evidence_list">
                                    <tr>
                                        <th>ID</th>
                                        <th>Name</th>
                                        <th>Creation Date</th>
                                        <th>Last Edit Time</th>
                                        <th>Project Name</th>
                                        <th colspan="2">Action</th>
                                    </tr>
                                    {% for evidence in evidence_list %}
                                        <form action="/delete_evidence" method="POST">
                                            <tr>
                                                <td>
                                                    <input type="text" name="evidence_id" value="{{ evidence.id }}"
                                                           readonly/>
                                                </td>
                                                <td>{{ evidence.name }}</td>
                                                <td>{{ evidence.create_date_time }}</td>
                                                <td>{{ evidence.last_edit_time }}</td>
                                                <td>{{ evidence.project_name }}</td>
                                                <td>
                                                    <a href="{{ url_for('evidence.view') }}?evidence_id={{ evidence.id }}">View</a>
                                                </td>
                                                <td><input type="submit" value="Delete"></td>
                                            </tr>
                                        </form>
                                    {% endfor %}
                                </table>
                            {% endif %}
                        {% endif %}
                    </div>
                </td>
            </tr>
        </table>
    {% endif %}
{% endblock %}
